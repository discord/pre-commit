#!/usr/bin/env bash
# File generated by pre-commit: https://pre-commit.com
# ID: 138fd403232d2ddd5efb44317e38bf03

# start templated
INSTALL_PYTHON=''
ARGS=(hook-impl)
# end templated

HERE="$(cd "$(dirname "$0")" && pwd)"

(
    REPO_ROOT="${HERE}/../.."
    export CLYDE_ROOT="${REPO_ROOT}/discord_clyde"
    if [[ "$(uname)" = MINGW* ]] || [[ "$(uname)" = MSYS* ]]; then
        export CLYDE_ENV="${INSTALL_PYTHON%\\Scripts\\python.exe}"
    else
        export CLYDE_ENV="${INSTALL_PYTHON%/bin/python}"
    fi

    if "${CLYDE_ROOT}/setup/detect_changes.sh" has_diverged_from_tracking '-E "setup.py|requirements.txt"'; then
        "${REPO_ROOT}/clyde" noop
    fi
)

COMMIT_ARGS+=(--hook-dir "$HERE" --)
PUSH_ARGS+=(--hook-dir "$HERE" -- "$@")

if [ -x "$INSTALL_PYTHON" ]; then
    PRE_PUSH_PRO=1 "$INSTALL_PYTHON" -mpre_commit "${COMMIT_ARGS[@]}" && exec "$INSTALL_PYTHON" -mpre_commit "${PUSH_ARGS[@]}"
elif command -v pre-commit > /dev/null; then
    exec pre-commit "${ARGS[@]}"
else
    echo '`pre-commit` not found.  Did you forget to activate your virtualenv?' 1>&2
    exit 1
fi
